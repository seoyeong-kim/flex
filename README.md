# Flex (카카오페이 사전과제)
카카오페이 '돈 뿌리기' 기능의 REST API를 구현한 프로젝트입니다.

---

## 해결 전략

- **도메인 주도 설계**
    - 비즈니스 로직들을 최대한 Domain Layer에 집약
    - Application Layer의 분기 로직 간소화
    - `moneyflex(돈뿌리기)` 를 root aggregate 으로, 같은 싸이클을 갖는 `SplitMoney(분배된 돈)`와 `ReceviedMoney(받은 돈)`을 포함한 애그리거트 구현

- **다량의 요청에 대한 순서 보장**
    - `@Version` 애노테이션 사용

## 용어정리
| 한글명 | 영문명 | 설명 |
| --- | --- | --- |
| 돈 뿌리기 | MoneyFlex | 유저가 대화방에서 생성한 돈 뿌리기 한 건 |
| 분배된 돈 | SplitMoney | 한 건의 돈뿌리기에서 참여자 수 만큼 랜덤으로 나뉘어진 돈 |
| 받은 돈 | ReceivedMoney | 돈뿌리기 참여자가 받은 돈 |

## 요구사항
- 뿌리기
    - [x] 뿌릴 금액, 뿌릴 인원을 요청값으로 받는다.
    - [x] [ 직접 정의한 사항 ] *뿌릴 인원 수는 최소 3명이다.*
    - [x] [ 직접 정의한 사항 ] *뿌릴 금액은 인원 수를 초과해야 한다.*
    - [x] 뿌리기 요청에 대해 `돈 뿌리기`를 생성하고 고유 토큰값을 발급한다.
    - [x] 토큰은 3자리 문자열 이다.
    - [x] 토큰은 예측이 불가능하다.
    - [x] 뿌릴 금액을 인원수에 맞게 분배하여 저장한다.(`분배된 돈`)
    - [x] [ 직접 정의한 사항 ] *분배된 금액은 최소 1원 이상이어야 한다.*
    - [x] 발급된 토큰을 응답값으로 내려준다.
- 받기
    - [x] `돈 뿌리기` 발급한 token을 요청값으로 받는다.
    - [x] token에 해당하는 `분배된 돈`을 사용자에게 할당한다.
    - [x] 사용자는 한 건의 `돈 뿌리기`에 한번만 참여 가능하다.
    - [x] 사용자는 자신이 생성한 `돈 뿌리기`에 참여할 수 없다.
    - [x] 대화방이 동일한 사용자만 받을 수 있다.
    - [x] 10분이 경과한 `돈 뿌리기` 참여시 실패 응답이 내려간다.
    - [x] 할당된 금액을 응답값으로 내려준다.
- 조회
    - [x] `돈 뿌리기` 발급한 token을 요청값으로 받는다.
    - [x] 뿌린돈은 7일간만 조회가능하다.
    - [x] `돈 뿌리기` 조회는 생성한 사용자만 가능하다.
    - [x] 다른 사람이 생성한 `돈 뿌리기` 조회시 실패 응답이 내려간다.
    - [x] 유효하지 않은 token의 `돈 뿌리기` 조회시 실패 응답이 내려간다.

## 환경
- Local에서 바로 실행 가능하도록 Embedded DB(H2)를 사용